<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programa Despertai</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; background: #121212; color: white; }
        .card { background: #1e1e1e; padding: 2rem; border-radius: 20px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.5); width: 80%; max-width: 300px; }
        button { padding: 15px 40px; font-size: 1.2rem; cursor: pointer; border: none; border-radius: 50px; transition: 0.3s; font-weight: bold; width: 100%; }
        .play { background: #2ecc71; color: white; }
        .pause { background: #e74c3c; color: white; display: none; }
        #status { font-size: 1.1rem; margin: 1rem 0; color: #bdc3c7; }
        h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
    </style>
</head>
<body>
    <div class="card">
        <h1>Rádio Clube FM 104,9</h1>
        <p id="status">Aguardando...</p>
        
        <button id="btnPlay" class="play" onclick="toggleAudio()">PLAY</button>
        <button id="btnPause" class="pause" onclick="toggleAudio()">PAUSE</button>
    </div>

    <script>
        const streamUrl = "https://radio.saopaulo01.com.br/8020/stream";
        const audio = new Audio(streamUrl);
        const btnPlay = document.getElementById('btnPlay');
        const btnPause = document.getElementById('btnPause');
        const statusText = document.getElementById('status');

        // Configuração da Media Session para ajudar o Android a manter o áudio
        function updateMediaSession() {
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: 'Rádio Clube FM 104,9',
                    artist: 'Rádio Ao Vivo',
                    album: 'No Ar'
                });

                navigator.mediaSession.setActionHandler('play', () => toggleAudio());
                navigator.mediaSession.setActionHandler('pause', () => toggleAudio());
            }
        }
        
        function toggleAudio() {
            if (audio.paused) {
                audio.play().then(() => {
                    updateMediaSession();
                    statusText.innerText = "NO AR...";
                    btnPlay.style.display = 'none';
                    btnPause.style.display = 'inline-block';
                }).catch(e => {
                    statusText.innerText = "Erro ao conectar";
                });
            } else {
                audio.pause();
                // Reseta o stream para não acumular buffer/atraso
                audio.src = ""; 
                audio.src = streamUrl;
                audio.load();
                
                statusText.innerText = "Aguardando...";
                btnPlay.style.display = 'inline-block';
                btnPause.style.display = 'none';
            }
        }

        audio.addEventListener('error', () => {
            statusText.innerText = "Stream offline";
            btnPlay.style.display = 'inline-block';
            btnPause.style.display = 'none';
        });

        audio.addEventListener('loadstart', () => {
            if(!audio.paused) statusText.innerText = "Conectando...";
        });
    </script>
</body>
</html>